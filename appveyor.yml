platform: Any CPU
configuration: AppVeyorCI

# build cache to preserve files/folders between builds
cache:
  - packages -> **\packages.config  # preserve "packages" directory in the root of build folder but will reset it if packages.config is modified
  - install-packages

install:
  - ps: 'Write-Host "Installing 2007 Office System Driver: Data Connectivity Components..."'
  - ps: '(New-Object Net.WebClient).DownloadFile("https://www.microsoft.com/en-us/download/confirmation.aspx?id=54920&6B49FDFB-8E5B-4B07-BC31-15695C5A2143=1", "$env:APPVEYOR_BUILD_FOLDER\install-packages\AccessDatabaseEngine.exe")'
  - ps: .\install-packages\AccessDatabaseEngine.exe /quiet
  - ps: 'Write-Host "OK" -foregroundcolor Green'
before_build:
  - nuget restore
